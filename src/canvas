export class Screen {
    constructor(width, height, color, numberOfTilesX, numberOfTilesY){
        this.width = width;
        this.height = height;
        this.color = color;
        this.numberOfTilesX = numberOfTilesX;
        this.numberOfTilesY = numberOfTilesY;
    }
    createCanvas(){
        var canvas = document.createElement("canvas");
        canvas.width = this.width;
        canvas.height = this.height;
        canvas.style.backgroundColor = this.color;
        document.body.appendChild(canvas);
        this.canvas=canvas;
    }
    fillCanvasWithFramingLines(color){
        var ctx = this.canvas.getContext("2d");
        ctx.fillStyle = color;
        for(var i = 0; i < this.numberOfTilesX; i++){
            this.drawLine(i*this.width/this.numberOfTilesX,0,i*this.width/this.numberOfTilesX,this.height,color);
        }
        for(var i = 0; i < this.numberOfTilesY; i++){
            this.drawLine(0,i*this.height/this.numberOfTilesY,this.width,i*this.height/this.numberOfTilesY,color);
        }
    }

    drawLine(x1, y1, x2, y2, color){
        var ctx = this.canvas.getContext("2d");
        ctx.strokeStyle = color;
        ctx.beginPath();
        ctx.moveTo(x1, y1);
        ctx.lineTo(x2, y2);
        ctx.stroke();
    }

    fillTile(x, y, color){
        if(this.checkCoordinates(x, y)){
            var ctx = this.canvas.getContext("2d");
            ctx.fillStyle = color;
            ctx.fillRect(x*this.width/this.numberOfTilesX, y*this.height/this.numberOfTilesY, this.width/this.numberOfTilesX, this.height/this.numberOfTilesY);
        }
        else{
            consolelog("Coordinates out of bounds");
        }
    }

    checkCoordinates(x,y){
        if(x < this.numberOfTilesX && y < this.numberOfTilesY && x >= 0 && y >= 0){
            return true;
        }
        else{
            return false;
        }
    }

    transformToCoordinates(x, y){
        return [x*this.width/this.numberOfTilesX, y*this.height/this.numberOfTilesY];
    }

    reverseTransformToCoordinates(x, y){
        return [x/this.width*this.numberOfTilesX, y/this.height*this.numberOfTilesY];
    }

    roundLowCoordinates([x, y]){
        return [Math.floor(x), Math.floor(y)];
    }



    whenCanvasIsClickedCallBackCoordinates(){
        this.canvas.addEventListener("click", function(event){
            var x = event.offsetX;
            var y = event.offsetY;
            var coordinates = this.reverseTransformToCoordinates(x, y);
            var roundedCoordinates = this.roundLowCoordinates(coordinates);
            this.fillTile(roundedCoordinates[0], roundedCoordinates[1], "#ad2929");
        }.bind(this));
    }

}